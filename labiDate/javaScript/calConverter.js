(function(){var lunarInfo=new Array(19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448);var Gan=new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸");var Zhi=new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥");var Animals=new Array("鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪");var sTermInfo=new Array(0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758);var nStr1=new Array("日","一","二","三","四","五","六","七","八","九","十");var nStr2=new Array("初","十","廿","卅","□");var cmonthName=new Array("正","二","三","四","五","六","七","八","九","十","十一","腊");var sFtv=new Array("0101*元旦","0214 情人节","0308 妇女节","0312 植树节","0401 愚人节","0422 地球日","0501 劳动节","0504 青年节","0531 无烟日","0601 儿童节","0606 爱眼日","0701 建党日","0707 抗战纪念日","0801 建军节","0910 教师节","0918 九·一八事变纪念日","1001*国庆节","1031 万圣节","1111 光棍节","1201 艾滋病日","1213 南京大屠杀纪念日","1224 平安夜","1225 圣诞节");var wFtv=new Array("0520 母亲节","0630 父亲节","1144 感恩节");var lFtv=new Array("0101*春节","0115 元宵节","0202 龙抬头","0505 端午节","0707 七夕","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1223 小年","0100*除夕");function lYearDays(y){var i,sum=348;for(i=32768;i>8;i>>=1){sum+=(lunarInfo[y-1900]&i)?1:0}return(sum+leapDays(y))}function leapDays(y){if(leapMonth(y)){return((lunarInfo[y-1900]&65536)?30:29)}else{return(0)}}function leapMonth(y){return(lunarInfo[y-1900]&15)}function monthDays(y,m){return((lunarInfo[y-1900]&(65536>>m))?30:29)}function Lunar(date){var objDate=new Date(date.getFullYear(),date.getMonth(),date.getDate());var i,leap=0,temp=0;var baseDate=new Date(1900,0,31);var offset=(objDate-baseDate)/86400000;this.dayCyl=offset+40;this.monCyl=14;for(i=1900;i<2050&&offset>0;i++){temp=lYearDays(i);offset-=temp;this.monCyl+=12}if(offset<0){offset+=temp;i--;this.monCyl-=12}this.year=i;this.yearCyl=i-1864;leap=leapMonth(i);this.isLeap=false;for(i=1;i<13&&offset>0;i++){if(leap>0&&i==(leap+1)&&this.isLeap==false){--i;this.isLeap=true;temp=leapDays(this.year)}else{temp=monthDays(this.year,i)}if(this.isLeap==true&&i==(leap+1)){this.isLeap=false}offset-=temp;if(this.isLeap==false){this.monCyl++}}if(offset==0&&leap>0&&i==leap+1){if(this.isLeap){this.isLeap=false}else{this.isLeap=true;--i;--this.monCyl}}if(offset<0){offset+=temp;--i;--this.monCyl}this.month=i;this.day=offset+1}function Solar(date,isLeapMonth){var lyear=date.getFullYear(),lmonth=date.getMonth()+1,lday=date.getDate(),offset=0,leap=isLeap(lyear);for(var i=1900;i<lyear;i++){offset+=lYearDays(i)}for(var i=1;i<lmonth;i++){if(i==leapMonth(lyear)){offset+=leapDays(lyear)}offset+=monthDays(lyear,i)}if(leap&&isLeapMonth){offset+=monthDays(lyear,i)}offset+=parseInt(lday)-1;var baseDate=new Date(1900,0,31);var solarDate=new Date(baseDate.valueOf()+offset*86400000);this.year=solarDate.getFullYear();this.month=solarDate.getMonth();this.day=solarDate.getDate();this.isLeap=leap}function isLeap(year){return year%4==0&&(year%100!=0||year%400==0)}function getAnimalYear(year){return Animals[((year-1900)%12)]}function cyclical(num){return(Gan[num%10]+Zhi[num%12])}function easter(y){var term2=sTerm(y,5);var dayTerm2=new Date(Date.UTC(y,2,term2,0,0,0,0));var lDayTerm2=new Lunar(dayTerm2);if(lDayTerm2.day<15){var lMlen=15-lDayTerm2.day}else{var lMlen=(lDayTerm2.isLeap?leapDays(y):monthDays(y,lDayTerm2.month))-lDayTerm2.day+15}var l15=new Date(dayTerm2.getTime()+86400000*lMlen);var dayEaster=new Date(l15.getTime()+86400000*(7-l15.getUTCDay()));this.m=dayEaster.getUTCMonth();this.d=dayEaster.getUTCDate()}function getCDay(d){var s;switch(d){case 10:s="初十";break;case 20:s="二十";break;break;case 30:s="三十";break;break;default:s=nStr2[Math.floor(d/10)];s+=nStr1[d%10]}return(s)}var solarTerm=new Array("小寒","大寒","立春","雨水","驚蟄","春分","清明","谷雨","立夏","小滿","芒種","夏至","小暑","大暑","立秋","處暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至");var solarTermBase=new Array(4,19,3,18,4,19,4,19,4,20,4,20,6,22,6,22,6,22,7,22,6,21,6,21);var solarTermIdx="0123415341536789:;<9:=<>:=1>?012@015@015@015AB78CDE8CD=1FD01GH01GH01IH01IJ0KLMN;LMBEOPDQRST0RUH0RVH0RWH0RWM0XYMNZ[MB\\]PT^_ST`_WH`_WH`_WM`_WM`aYMbc[Mde]Sfe]gfh_gih_Wih_WjhaWjka[jkl[jmn]ope]qph_qrh_sth_W";var solarTermOS="211122112122112121222211221122122222212222222221222122222232222222222222222233223232223232222222322222112122112121222211222122222222222222222222322222112122112121222111211122122222212221222221221122122222222222222222222223222232222232222222222222112122112121122111211122122122212221222221221122122222222222222221211122112122212221222211222122222232222232222222222222112122112121111111222222112121112121111111222222111121112121111111211122112122112121122111222212111121111121111111111122112122112121122111211122112122212221222221222211111121111121111111222111111121111111111111111122112121112121111111222111111111111111111111111122111121112121111111221122122222212221222221222111011111111111111111111122111121111121111111211122112122112121122211221111011111101111111111111112111121111121111111211122112122112221222211221111011111101111111110111111111121111111111111111122112121112121122111111011111121111111111111111011111111112111111111111011111111111111111111221111011111101110111110111011011111111111111111221111011011101110111110111011011111101111111111211111001011101110111110110011011111101111111111211111001011001010111110110011011111101111111110211111001011001010111100110011011011101110111110211111001011001010011100110011001011101110111110211111001010001010011000100011001011001010111110111111001010001010011000111111111111111111111111100011001011001010111100111111001010001010000000111111000010000010000000100011001011001010011100110011001011001110111110100011001010001010011000110011001011001010111110111100000010000000000000000011001010001010011000111100000000000000000000000011001010001010000000111000000000000000000000000011001010000010000000";function sTerm(y,n){return(solarTermBase[n]+Math.floor(solarTermOS.charAt((Math.floor(solarTermIdx.charCodeAt(y-1900))-48)*24+n)))}function calElement(sYear,sMonth,sDay,week,lYear,lMonth,lDay,isLeap,cYear,cMonth,cDay){this.sYear=sYear;this.sMonth=sMonth;this.sDay=sDay;this.week=week;this.lYear=lYear;this.lMonth=lMonth;this.lDay=lDay;this.isLeap=isLeap;this.cYear=cYear;this.cMonth=cMonth;this.cDay=cDay;this.lunarDay=getCDay(lDay);this.lunarMonth=cmonthName[lMonth-1];this.lunarYear=getAnimalYear(lYear);this.lunarFestival="";this.solarFestival="";this.solarTerms=""}function CalConverter(){this.solar2lunar=function(date){var sYear=date.getFullYear(),sMonth=date.getMonth(),sDay=date.getDate(),weekDay=nStr1[date.getDay()],lunar=new Lunar(date),lunarYear=lunar.year,lunarMonth=lunar.month,lunarDay=lunar.day,isLeap=lunar.isLeap;return addFstv(sYear,sMonth,sDay,weekDay,lunarYear,lunarMonth,lunarDay,isLeap)};this.lunar2solar=function(date,isLeapMonth){var lunarYear=date.getFullYear(),lunarMonth=date.getMonth()+1,lunarDay=date.getDate(),solar=new Solar(date,isLeapMonth),sYear=solar.year,sMonth=solar.month,sDay=solar.day,weekDay=nStr1[new Date(sYear,sMonth,sDay).getDay()],isLeap=solar.isLeap,cYear,cMonth,cDay,that={};return addFstv(sYear,sMonth,sDay,weekDay,lunarYear,lunarMonth,lunarDay,isLeap)}}function addFstv(sYear,sMonth,sDay,weekDay,lunarYear,lunarMonth,lunarDay,isLeap){var cYear,cMonth,cDay,that={};if(sMonth<2){cYear=cyclical(sYear-1900+36-1)}else{cYear=cyclical(sYear-1900+36)}var term2=sTerm(sYear,2);var firstNode=sTerm(sYear,sMonth*2);cMonth=cyclical((sYear-1900)*12+sMonth+12);if(sMonth==1&&(sDay+1)==term2){cYear=cyclical(cYear-1900+36)}if((sDay+1)==firstNode){cMonth=cyclical((sYear-1900)*12+sMonth+13)}var dayCyclical=Date.UTC(sYear,sMonth,1,0,0,0,0)/86400000+25567+10;cDay=cyclical(dayCyclical+sDay-1);that=new calElement(sYear,sMonth+1,sDay,weekDay,lunarYear,lunarMonth,lunarDay,isLeap,cYear,cMonth,cDay);tmp1=sTerm(sYear,sMonth*2)-1;tmp2=sTerm(sYear,sMonth*2+1)-1;if(tmp1==(sDay-1)){that.solarTerms=solarTerm[sMonth*2]}if(tmp2==(sDay-1)){that.solarTerms=solarTerm[sMonth*2+1]}for(var i=0,item;item=sFtv[i];i++){if(item.match(/^(\d{2})(\d{2})([\s\*])(.+)$/)){if(Number(RegExp.$1)==(sMonth+1)){if(Number(RegExp.$2)==sDay){that.solarFestival+=RegExp.$4+" "}}}}for(i=0,item;item=wFtv[i];i++){if(item.match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/)){if(Number(RegExp.$1)==(sMonth+1)){tmp1=Number(RegExp.$2);tmp2=Number(RegExp.$3);if(tmp1<5){var wFtvDate=(tmp2==0?7:0)+(tmp1-1)*7+tmp2;if(wFtvDate==sDay){that.solarFestival+=RegExp.$5+" "}}}}}for(i=0,item;item=lFtv[i];i++){if(item.match(/^(\d{2})(.{2})([\s\*])(.+)$/)){tmp1=Number(RegExp.$1);tmp2=Number(RegExp.$2);if(tmp1==lunarMonth&&tmp2==lunarDay){that.lunarFestival+=RegExp.$4+" "}}}return that}window.CalConverter=CalConverter})();